<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ZK Crowdfunding Platform</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      .hidden {
        display: none;
      }

      body > .pure-g {
        max-width: 1200px;
        width: 1200px;
        margin: auto;
      }

      div {
        margin-bottom: 5px;
      }

      .loader {
        border: 4px solid #f3f3f3; /* Light grey */
        border-top: 4px solid #3498db; /* Blue */
        border-radius: 50%;
        width: 20px;
        height: 20px;
        animation: spin 2s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .badge {
        display: inline-block;
        padding: 3px 6px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: bold;
        color: white;
      }

      .badge-setup {
        background-color: #6c757d;
      }

      .badge-active {
        background-color: #28a745;
      }

      .badge-computing {
        background-color: #ffc107;
        color: #212529;
      }

      .badge-completed {
        background-color: #007bff;
      }

      .result-indicator {
        font-weight: bold;
      }

      .result-success {
        color: #28a745;
      }

      .result-failure {
        color: #dc3545;
      }

      .info-panel {
        background-color: #f8f9fa;
        border-left: 4px solid #17a2b8;
        padding: 10px;
        margin-top: 10px;
      }

      .status-panel {
        background-color: #e9ecef;
        border-radius: 5px;
        padding: 15px;
        margin-bottom: 15px;
      }

      /* Message sections */
      .message-section {
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 15px;
      }

      .message-section.success {
        background-color: rgba(40, 167, 69, 0.1);
        border-left: 4px solid #28a745;
        color: #155724;
      }

      .message-section.error {
        background-color: rgba(220, 53, 69, 0.1);
        border-left: 4px solid #dc3545;
        color: #721c24;
      }

      .message-section.info {
        background-color: rgba(0, 123, 255, 0.1);
        border-left: 4px solid #007bff;
        color: #004085;
      }
    </style>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css"
      integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls"
      crossorigin="anonymous" />
  </head>

  <body>
    <div class="pure-g">
      <div class="pure-u-1-1">
        <h1>ZK Crowdfunding Platform</h1>
        <p>Privacy-preserving crowdfunding with threshold-based reveal using MPC on Partisia Blockchain</p>

        <div>
          <h2>Account</h2>
          <div id="connection-status">
            <p>Currently not logged in.</p>
          </div>

          <div id="private-key-connect">
            <form onSubmit="return false;" class="pure-form">
              <input
                class="pure-button pure-button-primary"
                id="private-key-connect-btn"
                type="submit"
                value="Login using private key" />
              <input id="private-key-value" name="private-key-value" type="password" placeholder="Enter private key" />
            </form>
          </div>

          <div id="wallet-connect">
            <form class="pure-form">
              <input
                class="pure-button pure-button-primary"
                id="wallet-connect-btn"
                type="button"
                value="Login using MPC Wallet" />
            </form>
          </div>

          <div id="metamask-connect">
            <form>
              <input
                class="pure-button pure-button-primary"
                id="metamask-connect-btn"
                type="button"
                value="Login using MetaMask snap" />
            </form>
          </div>

          <div id="wallet-disconnect" class="hidden">
            <form>
              <input
                class="pure-button pure-button-primary"
                id="wallet-disconnect-btn"
                type="button"
                value="Logout" />
            </form>
          </div>
        </div>

        <h2 id="current-address">Crowdfunding Contract Address: None</h2>
        <div id="address">
          <form onSubmit="return false;" class="pure-form">
            <input id="address-value" name="address-value" type="text" placeholder="Enter contract address" />
            <input
              id="address-btn"
              type="submit"
              value="Set address"
              class="pure-button pure-button-primary" />
          </form>
        </div>
        <br />
        <div id="browser-link"></div>

        <div id="contract-interaction" class="hidden">
          <!-- Start Campaign Section -->
          <div id="start-campaign-section" class="hidden">
            <h2>Start Campaign</h2>
            <p>Transition the campaign from Setup state to Active state to allow contributions.</p>
            <form>
              <input
                class="pure-button pure-button-primary"
                id="start-campaign-btn"
                type="button"
                value="Start Campaign" />
            </form>
            <div id="start-campaign-transaction-link"></div>
          </div>

          <!-- Add Contribution Section -->
          <div id="add-contribution-section" class="hidden">
            <h2>Add Contribution</h2>
            <p>Submit a private contribution to the crowdfunding campaign.</p>
            <form class="pure-form" name="add-contribution-form" onSubmit="return false;">
              <input id="contribution" name="contribution" type="number" placeholder="Enter amount" />
              <input
                class="pure-button pure-button-primary"
                id="add-contribution-btn"
                type="submit"
                value="Add Contribution" />
            </form>
            <div id="add-contribution-transaction-link"></div>
          </div>

          <!-- End Campaign Section -->
          <div id="end-campaign-section" class="hidden">
            <h2>End Campaign</h2>
            <p>End the campaign and start the computation to tally all contributions.</p>
            <form>
              <input
                class="pure-button pure-button-primary"
                id="end-campaign-btn"
                type="button"
                value="End Campaign" />
            </form>
            <div id="end-campaign-transaction-link"></div>
          </div>

          <!-- Withdraw Funds Section -->
          <div id="withdraw-funds-section" class="hidden">
            <h2>Withdraw Funds</h2>
            <p>Withdraw funds if the campaign was successful (reached funding target).</p>
            <form>
              <input
                class="pure-button pure-button-primary"
                id="withdraw-funds-btn"
                type="button"
                value="Withdraw Funds" />
            </form>
            <div id="withdraw-funds-transaction-link"></div>
          </div>
        </div>

        <div id="contract-state" class="hidden">
          <h2 id="state-header">Crowdfunding Project State</h2>
          <div id="update-state">
            <form>
              <input
                class="pure-button pure-button-primary"
                id="update-state-btn"
                type="button"
                value="Refresh State" />
              <input id="refresh-loader" class="loader hidden" />
            </form>
          </div>

          <div class="status-panel">
            <h3>Project Details</h3>
            <div id="title-value"></div>
            <div id="description-value"></div>
            <div id="status-value"></div>
            <div id="funding-target-value"></div>
            <div id="deadline-value"></div>
          </div>

          <div class="status-panel">
            <h3>Campaign Progress</h3>
            <div id="num-contributors"></div>
            <div id="total-raised"></div>
            <div id="campaign-result"></div>
          </div>

          <div class="status-panel">
            <h3>Project Owner</h3>
            <div id="owner-value"></div>
          </div>

          <div class="info-panel">
            <h3>About Privacy-Preserving Crowdfunding</h3>
            <p>
              This platform uses zero-knowledge proofs to keep individual contributions private 
              while ensuring transparency in the overall funding outcome.
            </p>
            <ul>
              <li><strong>Private Contributions:</strong> Individual contribution amounts are never revealed</li>
              <li><strong>Threshold-Based Reveal:</strong> The total amount raised is only revealed after the campaign has ended</li>
              <li><strong>Multi-Party Computation:</strong> Secure MPC is used to tally contributions without exposing individual data</li>
            </ul>
          </div>
        </div>
        
        <!-- Container for dynamic messages -->
        <div id="messages-container"></div>
      </div>
    </div>
  </body>
</html>